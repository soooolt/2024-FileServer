<!-- コンテンツ一覧 -->
<div class="main base-color">
    <section class="container-fluid">
        <div class="row row-cols-3 g-2">
            {{range $index, $_ := .fileinfos}}
            <div id="content-panel" class="content-list col d-flex flex-column justify-content-center align-items-center">
                <div class="main-color thumbnail thumbnail-color">
                    <!-- 画像本体 -->
                    {{if or (eq .TYPE "image") (eq .TYPE "animated")}}
                        <a href="/view?filename={{.Name}}" class="d-flex flex-column justify-content-center align-items-center">
                            <img src="{{.Path}}" alt="{{.Name}}" class="img-fluid center w-100">
                            <p class="text-center w-100">{{.Name}}</p>
                        </a>
                    {{else if eq .TYPE "movie"}}
                        <a href="/view?filename={{.Name}}" class="d-flex flex-column justify-content-center align-items-center">
                            <video src="{{.Path}}" controls class="img-fluid center w-100"></video>
                            <p class="text-center w-100">{{.Name}}</p>
                        </a>
                    {{end}}
                    <!-- タグの表示 -->
                    <div class="caption">
                        <!-- タグ一覧 -->
                        <div class="row">
                            <div class = "wrap">
                                <i>Tag:</i>
                                {{range .Tags}}
                                    <a class="tag-item accent-color base-color-text" href="">{{.}}</a>
                                {{end}}
                                <!-- タグ追加キー -->
                                <a class="tag-add-botton" href="#" onclick="showInputForm(event, 'inputForm{{$index}}')">+</a>
        
                                <!-- 隠れている入力フォーム -->
                                <div id="inputForm{{$index}}" style="display: none;">
                                    <form action="/add_tag" method="get">
                                        <div class="input-group input-group-sm">
                                            <!-- タグの入力 -->
                                            <input id="input-add-tag" type="text" name="add_tag" class="add-tag-input" placeholder="Search" onkeypress="return handleKeyPress(event)">
                                            <!-- 画像IDの入力（隠しフィールド） -->
                                            <input type="hidden" name="image_id" value="{{$index}}">
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {{end}}
        </div>
    </section>
    <!-- ページネーション -->
    <section class="container-fluid">
        <div class="row">
            <div class="col-12 d-flex justify-content-center">
                {{if .hasPrev}}
                    <a href="/search?page={{.prevPage}}" class="btn btn-primary">前のページ</a>
                {{end}}
                {{if .hasNext}}
                    <a href="/search?page={{.nextPage}}" class="btn btn-primary">次のページ</a>
                {{end}}
            </div>
        </div>
    </section>
</div>

<!-- ファイル情報の総数 -->
<section class="container-fluid">
    <div class="row">
        <div class="col-12 d-flex justify-content-center">
            <p>総数: {{.total}}件</p>
        </div>
    </div>
</section>